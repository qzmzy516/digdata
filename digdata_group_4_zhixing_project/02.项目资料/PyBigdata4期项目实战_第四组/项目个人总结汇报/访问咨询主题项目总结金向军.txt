访问与咨询主题项目总结:

	主题需求:  对知行教育网站的访问人数和咨询人数进行统计
	维度:  年 季度 月 天 小时 地区 来源渠道 搜索来源 来源页面
	
	
	指标:                            
	      访问用户数        --      id(用户id)
	      访问IP数          --      ip
		  创建的session数   --      session_id
		  咨询人数          --      msg_count    (当访问的用户给客服发的消息大于1时, 就是咨询用户)
		  
	
	ods层 :  经过对主题进行分析知道我们需要数据源中的两个表  ①用户咨询主表 和 ②用户咨询副表 在ods层中我们不需要对数据进行额外的处理
			 只需要把数据源中的原始数据全量导入即可, 写出sqoop脚本 在Linux运行  ods的表建成分区表,所以在原表的基础上要添加一个分区字段dt
			 
	dwd层 : 用户访问和咨询的数据一般不会更改,所以不需要进行拉链 只要首次全量导入 后续导入新增数据即可
			对ods层的表进行清洗转化并区分事实表和维度表 , 这两个表维度已经退化完成 两个都是事实表,由于分析的维度有不同的时间粒度 要对时间字段进行转化 
			时间转换的方法 : 一丶 可以用 year quarter month函数进行提取
			                 二丶 通过 substring 函数截取出字段
							 三丶 把时间转换成时间戳类型 unix_timestamp(create_time)  然后用from_unixtime()函数将时间戳转化为需要的时间  例如 'yyyy-MM-dd HH:mm:ss'
							  
							     当时间类型不是标准时间格式时, 我们可以用字符串替换函数进行转化  regexp_replace('2022/10', '/', '-')  ==> '2022-10'
							 
	dwb层 : 将用户咨询主表和用户咨询副表进行关联创建宽表 字段求宁滥勿缺 防止后续的计算缺少值
			
			
	dm层  :  精准抽取dwb层的宽表字段, 建表时 总访问用户字段总咨询用户等需要聚合的字段类型要设为bigint 不然插入数据会报错
			 用grouping sets增强聚合  增加两个分组类型字段 time_type 和 group_type 通过grouping判断是什么 不在分组字段里的返回null
			 
			 